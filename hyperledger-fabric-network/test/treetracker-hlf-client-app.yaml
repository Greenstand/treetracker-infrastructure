#RUN THIS ON K8S DEFORE DEPLOYING APP

# kubectl create secret generic fabric-credentials -n hlf-treetracker-client-app \
#   --from-literal=FABRIC_CA_URL=https://root-ca.hlf-ca.svc.cluster.local:7054 \
#   --from-literal=FABRIC_CA_ADMIN_USER=admin \
#   --from-literal=FABRIC_CA_ADMIN_PASSWORD=adminpw                  

apiVersion: apps/v1
kind: Deployment
metadata:
  name: treetracker-hlf-client-app
  namespace: hlf-treetracker-client-app
spec:
  replicas: 1
  selector:
    matchLabels:
      app: fabric-app
  template:
    metadata:
      labels:
        app: fabric-app
    spec:
      containers:
        - name: app
          image: imos64/fabric-rest-gateway:latest
          env:
            - name: NODE_ENV
              value: "production"
            - name: FABRIC_WALLET_PATH
              value: "/app/wallet"
            - name: FABRIC_MSP_ID
              value: "Org1MSP"
            - name: FABRIC_CA_URL
              valueFrom:
                secretKeyRef:
                  name: fabric-credentials
                  key: FABRIC_CA_URL
            - name: FABRIC_CA_ADMIN_USER
              valueFrom:
                secretKeyRef:
                  name: fabric-credentials
                  key: FABRIC_CA_ADMIN_USER
            - name: FABRIC_CA_ADMIN_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: fabric-credentials
                  key: FABRIC_CA_ADMIN_PASSWORD
